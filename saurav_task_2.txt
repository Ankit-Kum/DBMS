                                                                                       DBMS TASK (8/09/2025)
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

QUESION 1 )-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------


CREATE TABLE pharmacy_sales (
  product_id   INTEGER,
  units_sold   INTEGER,
  total_sales  DECIMAL(12,2),
  cogs         DECIMAL(12,2),
  manufacturer VARCHAR(100),
  drug         VARCHAR(200)
);


INSERT INTO pharmacy_sales VALUES
(9,  37410, 293452.54, 208876.01, 'Eli Lilly', 'Zyprexa'),
(34, 94698, 600997.19, 521182.16, 'AstraZeneca', 'Surmontil'),
(61, 77023, 500101.61, 419174.97, 'Biogen', 'Varicose Relief'),
(136,144814,1084258.00,1006447.73, 'Biogen', 'Burkhart');

...................................................................................................................................................................//QUERY
SELECT
  drug,
  ROUND(SUM(COALESCE(total_sales,0) - COALESCE(cogs,0)), 2) AS total_profit
FROM pharmacy_sales
GROUP BY drug
ORDER BY total_profit DESC
LIMIT 3;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

QUESTION  3)------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

CREATE DATABASE IF NOT EXISTS practice_db;
USE practice_db;


CREATE TABLE parts_assembly (
  part          VARCHAR(100),
  finish_date   DATETIME,
  assembly_step INTEGER
);

INSERT INTO parts_assembly VALUES
('battery', '2022-01-22 00:00:00', 1),
('battery', '2022-02-22 00:00:00', 2),
('battery', '2022-03-22 00:00:00', 3),
('bumper',  '2022-01-22 00:00:00', 1),
('bumper',  '2022-02-22 00:00:00', 2),
('bumper',  NULL, 3),
('bumper',  NULL, 4);

.............................................................................................................................................................................................//QUERY

SELECT part, assembly_step
FROM parts_assembly
WHERE finish_date IS NULL;
